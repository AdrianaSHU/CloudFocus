{% extends 'base.html' %}
{% load static %}

{% block content %}

<div class="row">
  <div class="col-md-8 offset-md-2">
    <div class="card">
      <div class="card-body p-4">
        
        <h2 class="card-title text-center">Edit Your Profile</h2>

        <!-- Profile Picture Display -->
        <div class="text-center mb-4">
          <img src="
            {% if user.profile.profile_picture %}
              {{ user.profile.profile_picture.url }}
            {% else %}
              {% static 'images/default.png' %}
            {% endif %}
          " class="rounded-circle sidebar-profile-pic">
        </div>
        
        <form method="POST" enctype="multipart/form-data">
          {% csrf_token %}

          <fieldset class="mb-4">
            <legend class="border-bottom mb-3">User Info</legend>
            
            <div class="mb-3">
              <label class="form-label">Username (Cannot be changed)</label>
              <input type="text" class="form-control" value="{{ user.username }}" readonly disabled>
            </div>
            <div class="mb-3">
              <label class="form-label">Email (Cannot be changed)</label>
              <input type="email" class="form-control" value="{{ user.email }}" readonly disabled>
            </div>

            <div class="mb-3">
              <label for="{{ user_form.first_name.id_for_label }}" class="form-label">First name</label>
              {{ user_form.first_name }}
            </div>
            <div class="mb-3">
              <label for="{{ user_form.last_name.id_for_label }}" class="form-label">Last name</label>
              {{ user_form.last_name }}
            </div>
            
          </fieldset>
          
          <fieldset class="mb-4">
            <legend class="border-bottom mb-3">Profile Picture</legend>
            
            <div class="mb-3">
              <label for="{{ profile_form.profile_picture.id_for_label }}" class="form-label">Change Profile Picture</label>
              {{ profile_form.profile_picture }}
            </div>

            <div class="mb-3">
              <label class="form-label">Storage Option</label>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="storage_backend" id="localStorage" value="local" checked>
                <label class="form-check-label" for="localStorage">Local Storage</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="storage_backend" id="azureStorage" value="azure">
                <label class="form-check-label" for="azureStorage">Azure Blob Storage</label>
              </div>
            </div>

          </fieldset>
          
          <div class="d-grid">
            <button type="submit" class="btn btn-primary">Update Profile</button>
          </div>
        </form>

        <hr class="my-4">
        
        <fieldset>
          <legend class="border-bottom mb-3">Security</legend>
          <a href="{% url 'password_change' %}" class="btn btn-outline-danger">
            Change Your Password
          </a>
        </fieldset>

      </div>
    </div>
  </div>
</div>
{% endblock %}
